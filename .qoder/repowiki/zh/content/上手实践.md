# 上手实践

<cite>
**本文档中引用的文件**   
- [README.md](file://README.md)
- [PerfGarden.py](file://PerfGarden.py)
</cite>

## 目录
1. [检测APP启动按钮出现时间戳](#检测app启动按钮出现时间戳)
2. [识别录屏中加载动画持续时长](#识别录屏中加载动画持续时长)
3. [结合skip与cattail实现精准监控](#结合skip与cattail实现精准监控)

## 检测APP启动按钮出现时间戳

本案例展示如何配置perf-garden来检测APP启动过程中某个按钮的出现时间戳。通过模板匹配技术，可以精确识别特定UI元素在视频帧中的首次出现位置。

### YAML配置示例
```YAML
- path: "C:/Users/YourName/Documents/TestApp"
- max_threads: 4

- cattail:
    - template: "C:/Users/YourName/Documents/templates/start_button.jpg"
    - threshold: 0.85
    - crop: 50
    - leap: 3
```

### 目录结构说明
```
总文件夹/
├── config.yml
├── TestApp/
│   ├── frame_0001.jpg
│   ├── frame_0002.jpg
│   └── ...
└── templates/
    └── start_button.jpg
```

### 预期输出结果
运行后生成的CSV报告将包含以下内容：
|子文件夹名 |cattail1|
|------|---------------|
|TestApp|frame_00125.jpg|

### 结果解读方法
- **时间戳计算**：假设视频帧率为30fps，检测到的frame_00125.jpg对应的时间为125/30≈4.17秒
- **置信度分析**：在PerfGarden.py中，cattail函数返回的confidence值表示匹配程度，高于0.85为可靠匹配
- **裁剪优化**：设置crop: 50仅分析屏幕底部50%区域，提高识别速度和准确性

**Section sources**
- [README.md](file://README.md#L62-L71)
- [PerfGarden.py](file://PerfGarden.py#L8-L49)

## 识别录屏中加载动画持续时长

本案例演示如何使用blover检测方法识别一段录屏中圆形加载动画的持续时长。该方法特别适用于无法通过模板匹配识别的动态元素。

### YAML配置示例
```YAML
- path: "C:/Users/YourName/Documents/LoadingTest"
- max_threads: 6

- cattail:
    - template: "C:/Users/YourName/Documents/templates/before_loading.jpg"
    - fade: false

- blover:
    - threshold: 1
    - crop: -30
    - fade: true
    - param2: 25
```

### 目录结构说明
```
总文件夹/
├── config.yml
├── LoadingTest/
│   ├── frame_0001.jpg
│   ├── frame_0002.jpg
│   └── ...
└── templates/
    ├── before_loading.jpg
    └── after_loading.jpg
```

### 预期输出结果
生成的CSV报告示例：
|子文件夹名 |cattail1|blover1|
|------|---------------|---------------|
|LoadingTest|frame_00045.jpg|frame_00102.jpg|

### 结果解读方法
- **持续时长计算**：加载动画持续时间为(102-45)/30=1.9秒（假设30fps）
- **fade参数应用**：设置fade: true表示检测圆形从出现到消失的完整过程
- **参数调优**：在PerfGarden.py中，blover函数的param2参数控制霍夫变换的灵敏度，值越小越容易检测到圆形
- **区域裁剪**：crop: -30仅分析顶部30%区域，避免其他圆形元素干扰

**Section sources**
- [README.md](file://README.md#L76-L87)
- [PerfGarden.py](file://PerfGarden.py#L83-L125)

## 结合skip与cattail实现精准监控

本案例展示如何结合skip跳过指令和cattail模板匹配，对特定时间段内的界面变化进行精准监控。这种组合策略可以有效跳过无关画面，聚焦关键操作区间。

### YAML配置示例
```YAML
- path: "C:/Users/YourName/Documents/WorkflowTest"
- max_threads: 8

- skip: 50

- cattail:
    - template: "C:/Users/YourName/Documents/templates/action_start.jpg"
    - crop: 0
    - fade: false

- skip: 20

- cattail:
    - template: "C:/Users/YourName/Documents/templates/action_end.jpg"
    - crop: 0
    - fade: true
```

### 目录结构说明
```
总文件夹/
├── config.yml
├── WorkflowTest/
│   ├── frame_0001.jpg
│   ├── frame_0002.jpg
│   └── ...
└── templates/
    ├── action_start.jpg
    └── action_end.jpg
```

### 预期输出结果
生成的CSV报告：
|子文件夹名 |skip1|cattail1|skip2|cattail2|
|------|-----|---------------|-----|---------------|
|WorkflowTest|跳过50张|frame_00089.jpg|跳过20张|frame_00156.jpg|

### 结果解读方法
- **时间区间分析**：关键操作发生在第89帧到第156帧之间，持续时间为(156-89)/30≈2.23秒
- **skip指令作用**：第一个skip: 50跳过前50帧的启动画面，第二个skip: 20跳过中间的等待时间
- **状态转换监控**：使用fade: true检测action_end模板的消失，确保捕捉完整的操作周期
- **性能优化**：通过合理设置skip值，减少不必要的图像处理，提高整体分析效率

**Section sources**
- [README.md](file://README.md#L88-L106)
- [PerfGarden.py](file://PerfGarden.py#L292-L329)